% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{splineOP_Rcpp}
\alias{splineOP_Rcpp}
\title{Dynamic Programming for Quadratic Spline Segmentation}
\usage{
splineOP_Rcpp(data, beta, S = 10L, nb_initSpeed = 5L, data_var = 1)
}
\arguments{
\item{data}{Numeric vector. The observed signal (e.g., time series) to be segmented.}

\item{beta}{Numeric scalar. Regularization penalty controlling the number of segments
(higher values favor fewer segments).}

\item{S}{Integer. Number of discrete states considered in the dynamic programming grid
(default = 10).}

\item{nb_initSpeed}{Integer. Number of candidate initial speeds to test (default = 5).}

\item{data_var}{Numeric. Variance of Gaussian noise used for random initialization of
the state matrix (default = 1.0).}
}
\value{
An integer vector giving the changepoint locations
}
\description{
This function performs dynamic programming (DP) to segment a univariate signal
using a quadratic spline model with penalized transitions. It is a wrapper
around a pure C++ backend (`splineOP`) that performs all numerical computations.

The algorithm searches for an optimal sequence of state transitions (segment boundaries)
minimizing the total quadratic reconstruction cost plus a regularization penalty `beta`.
Each segment is modeled by a quadratic function defined by positions and velocities
at its endpoints.
}
\details{
The algorithm has time complexity approximately \\(O(N^2 S^2)\\), where `N` is
the signal length and `S` is the number of states. The quadratic cost function
is precomputed using cumulative sums for efficiency, reducing per-interval
evaluations to constant time.
}
\examples{
# Simulate a noisy quadratic signal
N <- 1000
x <- 1:N
signal <- 0.01 * (x - N/2)^2 + rnorm(N, 0, 0.5)

# Run the dynamic programming segmentation
system.time({
  chpt <- splineOP_Rcpp(signal, beta = 500, S = 12, data_var = 0.01)
})

# Visualize the resulting segmentation
plot(signal, type = "l", main = "DP Quadratic Spline Segmentation")
abline(v = chpt, col = "red", lwd = 2)

}
